<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.8.25">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Emma Bell(A19247017)">

<title>Class 7: Machine Learning 1</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="Class07_files/libs/clipboard/clipboard.min.js"></script>
<script src="Class07_files/libs/quarto-html/quarto.js" type="module"></script>
<script src="Class07_files/libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="Class07_files/libs/quarto-html/axe/axe-check.js" type="module"></script>
<script src="Class07_files/libs/quarto-html/popper.min.js"></script>
<script src="Class07_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="Class07_files/libs/quarto-html/anchor.min.js"></script>
<link href="Class07_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="Class07_files/libs/quarto-html/quarto-syntax-highlighting-7b89279ff1a6dce999919e0e67d4d9ec.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="Class07_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="Class07_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="Class07_files/libs/bootstrap/bootstrap-d6a003b94517c951b2d65075d42fb01b.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">


</head>

<body class="fullcontent quarto-light">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Class 7: Machine Learning 1</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Emma Bell(A19247017) </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="background" class="level2">
<h2 class="anchored" data-anchor-id="background">Background</h2>
<p>Today we will begin our exploration of some important machine learning methods, namely <strong>clusterring</strong> and <strong>dimensionality reduction</strong>.</p>
<p>Let’s make up some input data for clustering where we know what the natural “clusters” are.</p>
<p>The function <code>rnorm()</code> can be useful here.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">5</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.03486886 1.59886304 1.06148575 0.64360940 0.90761837</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( <span class="fu">rnorm</span>(<span class="dv">5000</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>( <span class="fu">rnorm</span>(<span class="dv">5000</span>, <span class="at">mean=</span><span class="dv">10</span>))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Generate 30 random numbers centered at +3 and -3.</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean=</span><span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 2.9690910 4.0208645 3.6401394 3.2135769 3.3853455 2.9699124 1.4135292
 [8] 3.7123098 0.2247964 3.1507914 2.6653313 1.7236199 3.5294724 3.1921710
[15] 2.7106694 2.9883325 3.5422709 1.6809975 4.2082707 3.2757232 2.1356298
[22] 2.3512569 2.1280416 2.9519774 2.5098998 2.9501759 2.2724135 3.9240969
[29] 4.8404286 3.4672339</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean=</span><span class="sc">-</span><span class="dv">3</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] -2.298095 -4.295984 -3.369131 -2.016009 -4.686502 -2.946353 -3.760566
 [8] -1.601597 -1.741864 -3.199290 -2.690408 -3.012551 -3.687918 -3.160684
[15] -2.629784 -4.154235 -3.265206 -3.418283 -2.694881 -1.440973 -2.007459
[22] -1.873895 -4.455598 -2.510426 -3.449172 -2.592182 -4.092040 -2.321228
[29] -4.278440 -1.928922</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>tmp <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean=</span><span class="dv">3</span>),</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>        <span class="fu">rnorm</span>(<span class="dv">30</span>, <span class="at">mean=</span><span class="sc">-</span><span class="dv">3</span>))</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>tmp</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1]  3.0024138  2.5024748  2.6838029  3.6312311  1.9565586  2.4816108
 [7]  2.5379339  1.6531631  3.6982824  2.8552523  1.7493917  1.6803781
[13]  1.9617203  2.0540076  2.1280300  3.3448685  2.3682099  2.1897561
[19]  3.8680767  3.7592414  2.3839310  3.4666304  2.8894269  2.4005651
[25]  1.8926649  2.1095471  4.0966047  4.3140596  3.1526474  3.6244288
[31] -3.1138828 -0.9700417 -1.5048254 -2.7101143 -1.5162734 -2.5877745
[37] -3.1242266 -4.2056048 -4.2605904 -1.6721205 -2.9687420 -1.7707355
[43] -2.6069639 -2.5249297 -1.4539589 -2.8167488 -1.9655929 -2.4757030
[49] -1.3911732 -4.3677165 -3.8921892 -2.9474668 -2.9842936 -4.7685622
[55] -3.0360369 -2.6931863 -4.0946077 -2.5998936 -4.2086565 -2.2666520</code></pre>
</div>
</div>
<p>(rev=reverse), (cbind= puts stuff in columns, rbind puts into rows)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span><span class="fu">cbind</span>(<span class="at">x=</span>tmp, <span class="at">y=</span><span class="fu">rev</span>(tmp))</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="k-means-clustering" class="level2">
<h2 class="anchored" data-anchor-id="k-means-clustering">K-means clustering</h2>
<p>The main function in “base R” for K-means clustering is called <code>kmeans()</code></p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>km <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="dv">2</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>km</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 2 clusters of sizes 30, 30

Cluster means:
          x         y
1  2.747897 -2.783309
2 -2.783309  2.747897

Clustering vector:
 [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2

Within cluster sum of squares by cluster:
[1] 47.34287 47.34287
 (between_SS / total_SS =  90.6 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. What component of the results object details the cluster sizes? size!</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>size</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 30 30</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. What component of the results object details the cluster centres?</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>centers</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>          x         y
1  2.747897 -2.783309
2 -2.783309  2.747897</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. What component of the result objects details the cluster membership vector (ie our main result which points lie in which cluster)</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>cluster</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Plout our clustering results with points coloured by cluster and also add the cluster centres as new points coloured blue</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span> km<span class="sc">$</span>cluster)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(km<span class="sc">$</span>centers, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">pch=</span><span class="dv">15</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-12-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<blockquote class="blockquote">
<p>Q. run <code>kmeans()</code> again and this time produce four clusters (and call your result object <code>k4</code>) and make a results figure like above</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>k4 <span class="ot">&lt;-</span> <span class="fu">kmeans</span>(x, <span class="dv">4</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>k4</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>K-means clustering with 4 clusters of sizes 7, 9, 30, 14

Cluster means:
          x         y
1  2.804620 -4.256847
2  3.651180 -2.189602
3 -2.783309  2.747897
4  2.138853 -2.428208

Clustering vector:
 [1] 2 1 4 1 4 4 1 4 2 1 1 4 4 4 4 2 4 4 2 2 4 1 1 4 4 4 2 2 2 2 3 3 3 3 3 3 3 3
[39] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3

Within cluster sum of squares by cluster:
[1]  2.845623  6.448176 47.342870  5.353245
 (between_SS / total_SS =  93.9 %)

Available components:

[1] "cluster"      "centers"      "totss"        "withinss"     "tot.withinss"
[6] "betweenss"    "size"         "iter"         "ifault"      </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">col=</span>k4<span class="sc">$</span>cluster)</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">points</span>(k4<span class="sc">$</span>centers, <span class="at">col=</span><span class="st">"blue"</span>, <span class="at">pch=</span><span class="dv">15</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-14-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>The metric</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>km<span class="sc">$</span>tot.withinss</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 94.68574</code></pre>
</div>
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>k4<span class="sc">$</span>tot.withinss</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 61.98992</code></pre>
</div>
</div>
<blockquote class="blockquote">
<p>Q. Let’s try different number of K (centers) from 1 to 30 and see what the best result is</p>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="cn">NULL</span></span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">30</span>){</span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>ans <span class="ot">&lt;-</span> <span class="fu">c</span>(ans, <span class="fu">kmeans</span>(x, <span class="at">centers=</span> i)<span class="sc">$</span>tot.withinss)</span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>ans</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1012.512864   94.685741   76.836545   54.692899   41.849433   29.294089
 [7]   25.004482   34.785443   17.155498   16.156449   15.566881   17.278854
[13]   10.029243    8.315655   12.417391    7.377354    7.163920    7.468352
[19]    6.656549    5.447524    5.749759    5.279341    4.605532    4.434391
[25]    3.230219    3.904042    3.474629    3.858514    3.944408    2.277113</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb30"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(ans, <span class="at">typ=</span><span class="st">"o"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>best result is 2- the ’elbow point, meaning the best number of clusters is 2. <strong>Key-Point</strong>: K means will impose a clustering structure on your data even if it is not there- it iwll always give you the answer you asked for even if that answer is silly!</p>
</section>
<section id="hierarchal-clustering" class="level2">
<h2 class="anchored" data-anchor-id="hierarchal-clustering">Hierarchal Clustering</h2>
<p>The main function for this is called <code>hclust()</code>.</p>
<p>Unlike <code>kmeans()</code> (which does all the work for you) you can’t just pass <code>hclust()</code> our raw input data. It needs a “distance matrix” like the one returned from the <code>dist()</code> function.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>d <span class="ot">&lt;-</span> <span class="fu">dist</span>(x)</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">dist</span>(x)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>             1           2           3           4           5           6
2   2.00532308                                                            
3   0.46104542  1.61894970                                                
4   1.93308906  1.13450334  1.76968656                                    
5   1.12948863  1.61079936  0.73320375  2.18369179                        
6   0.92907961  1.17280520  0.48073137  1.56275359  0.62707767            
7   2.54466030  0.56102733  2.17356876  1.28433375  2.15526850  1.73344050
8   1.52822999  1.49009895  1.09999168  2.26838052  0.42046677  0.83006203
9   0.97352038  1.73797453  1.07236928  1.14909888  1.76018760  1.21989116
10  1.63218494  0.47392361  1.30361914  0.80194527  1.49841863  0.93413311
11  2.44633119  0.76969745  1.99958046  1.90155401  1.68729651  1.51970893
12  1.58563594  2.93497108  1.57094434  3.33382442  1.33098223  1.82963125
13  1.06148254  1.81536319  0.73268446  2.32553623  0.21754458  0.76436922
14  0.99504315  2.28745655  0.89385652  2.64959206  0.73409025  1.15269034
15  1.03303119  1.44139379  0.59658162  1.97295129  0.21135312  0.41606090
16  0.88189867  2.88062253  1.32294145  2.65613054  1.86093766  1.80227210
17  0.68477869  1.68907170  0.32437397  2.01472367  0.44471015  0.52353643
18  0.88103608  1.63193518  0.49409730  2.07145702  0.24862704  0.51892472
19  0.99764996  2.79433845  1.44568586  2.33591047  2.12245539  1.87703897
20  1.03233638  1.76546035  1.13693321  1.13311970  1.82362170  1.27940159
21  0.85789776  2.53930453  0.97503125  2.72473880  1.10689766  1.36740970
22  2.04726346  0.96555333  1.83595563  0.23375976  2.17648173  1.57155812
23  1.94224202  0.38696411  1.61882357  0.75006253  1.77697860  1.23862945
24  1.04769080  1.08920793  0.59594356  1.56721990  0.61881945  0.11977404
25  1.15527586  1.73179873  0.79123082  2.30068661  0.12326420  0.74013282
26  1.16630999  2.72090414  1.22637778  2.99388211  1.18681487  1.56464461
27  1.18064078  2.18789373  1.41709481  1.46061446  2.14011306  1.64755299
28  1.51683703  3.25461864  1.96390210  2.67828815  2.64007815  2.38798606
29  1.30528476  3.30323331  1.69594583  3.16100537  2.09758327  2.17223993
30  1.05104843  1.56758099  1.07189649  0.98074845  1.72010945  1.14546622
31  8.49199133  9.63850085  8.50619470 10.25085781  8.10071827  8.69892826
32  6.71931605  8.13923623  6.81485933  8.58454527  6.53748887  7.08616390
33  7.97627542  9.41780999  8.08377109  9.85315998  7.81554054  8.36155443
34  8.55125797  9.80553158  8.59868779 10.35898750  8.23887722  8.82205116
35  6.29044130  7.48799264  6.31026716  8.06153450  5.92678747  6.51614248
36  6.96779169  7.94586435  6.92622616  8.63269729  6.45608192  7.07041502
37  7.70185934  8.67995272  7.66405852  9.37141813  7.19448965  7.80910076
38  8.86231803  9.76632582  8.80889192 10.49727275  8.31491596  8.93476211
39  9.25320255 10.22981337  9.22102553 10.92946334  8.75193032  9.36706788
40  6.59387543  7.80316966  6.61910690  8.37239524  6.24054743  6.82858233
41  8.48328308  9.66548551  8.50822311 10.25878110  8.11741391  8.71103627
42  7.77289203  9.13750221  7.85350572  9.62214043  7.54605154  8.10859019
43  7.16412526  8.18816513  7.13673292  8.85484640  6.68347694  7.29400476
44  7.21342295  8.27828294  7.19812109  8.92559953  6.76028616  7.36690790
45  7.16578121  8.52696365  7.24301521  9.01137971  6.93467635  7.49697699
46  7.29217956  8.27331470  7.25322893  8.96089641  6.78443735  7.39866218
47  6.58401011  7.69315219  6.57842509  8.31443974  6.15785042  6.75915482
48  6.92018028  7.92816525  6.88685861  8.60079951  6.42752658  7.03935632
49  5.90615384  7.05983173  5.90983551  7.65343100  5.50775580  6.10270654
50  8.39329657  9.09383679  8.28493862  9.90633592  7.72870979  8.35545404
51  8.58891459  9.52840680  8.54413766 10.24218760  8.06182497  8.67943638
52  8.42505315  9.60320501  8.44856309 10.19845093  8.05607453  8.65019886
53  7.15580993  8.02904460  7.08631138  8.76367709  6.58048431  7.20171566
54  9.13630740  9.91889417  9.05179629 10.70266952  8.52008616  9.14517138
55  7.68172419  8.68532034  7.65102962  9.36478044  7.19058657  7.80313228
56  7.09051251  8.06255368  7.04792655  8.75299197  6.57573228  7.19058657
57  9.22782413 10.24623517  9.20726691 10.92598597  8.75299197  9.36478044
58  7.47615213  8.57555593  7.47227516  9.20726691  7.04792655  7.65102962
59  8.64546732  9.49097295  8.57555593 10.24623517  8.06255368  8.68532034
60  7.45158425  8.64546732  7.47615213  9.22782413  7.09051251  7.68172419
             7           8           9          10          11          12
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8   1.99159073                                                            
9   2.15935106  2.04545085                                                
10  0.93205181  1.50641724  1.26617539                                    
11  0.88457677  1.38676558  2.41149003  1.20376655                        
12  3.48455996  1.59335285  2.54833030  2.76322462  2.97734324            
13  2.36415429  0.59487143  1.79950243  1.67476348  1.90389040  1.12042768
14  2.84443695  1.09472715  1.91512820  2.08656812  2.42136093  0.68524223
15  1.99439130  0.50355720  1.57568390  1.29823894  1.59651739  1.49420813
16  3.41141291  2.28118206  1.53475308  2.48690386  3.32197673  1.66567417
17  2.25004289  0.84988660  1.39557528  1.45141616  1.94391339  1.32609062
18  2.18945999  0.65598007  1.54647784  1.44730417  1.81498504  1.31818544
19  3.27967136  2.52558221  1.18891819  2.35082512  3.35158710  2.22038121
20  2.17507343  2.10613567  0.06456493  1.29226578  2.44880076  2.60967348
21  3.10026896  1.50193872  1.83140045  2.26954810  2.76927384  0.75757380
22  1.05854262  2.21756563  1.33340031  0.71379455  1.72057687  3.37997819
23  0.66367784  1.73780007  1.49571340  0.31527329  1.15150351  3.06313957
24  1.65006354  0.76038870  1.30970005  0.89247243  1.40367159  1.87673740
25  2.27424870  0.46323701  1.84109568  1.62113307  1.78569897  1.21528606
26  3.28038073  1.53732555  2.13831580  2.49019122  2.87409809  0.44703026
27  2.58198802  2.45877636  0.46367752  1.71413439  2.87350896  2.75277252
28  3.71572338  3.04453551  1.56856487  2.79778923  3.84365280  2.63613258
29  3.84793843  2.51110809  2.05132333  2.93724184  3.67604683  1.53131594
30  1.97950364  1.97552062  0.18206777  1.09425460  2.25562912  2.59751062
31 10.11856363  8.14861576  9.46548501  9.59844365  9.35552381  6.93838609
32  8.66322422  6.67407286  7.68144796  8.01639551  7.99694887  5.26032613
33  9.94172626  7.95228590  8.93320187  9.29262055  9.27163228  6.53415662
34 10.30209659  8.31728989  9.52294553  9.73622791  9.56723198  7.02795350
35  7.98404558  5.99937837  7.26395078  7.42503032  7.25393080  4.74063533
36  8.40504801  6.46299277  7.93356068  7.94298918  7.61599536  5.38523156
37  9.13545005  7.19862180  8.66879887  8.68060625  8.34037117  6.12058051
38 10.20392625  8.29612885  9.82551578  9.79009806  9.38765751  7.27793460
39 10.67887311  8.75139430 10.22175620 10.23657388  9.87405072  7.67420118
40  8.29956127  6.31469295  7.56736612  7.73865556  7.56911423  5.04882750
41 10.15120253  8.17540647  9.45669859  9.61578387  9.39724587  6.93837792
42  9.65174408  7.66016066  8.73852335  9.03446129  8.95653872  6.29046066
43  8.65379495  6.70219910  8.13309225  8.17470885  7.87262862  5.58608595
44  8.75020595  6.79012178  8.18442347  8.25463238  7.97762675  5.64070699
45  9.04228769  7.05070927  8.13259334  8.42284432  8.35137255  5.67927463
46  8.73130064  6.79087368  8.25871050  8.27131405  7.94004799  5.71042396
47  8.17491356  6.20321481  7.55607232  7.65492029  7.41887126  5.01621124
48  8.39245239  6.44287116  7.88785224  7.91753376  7.61007197  5.33993491
49  7.55160339  5.57020162  6.87891756  7.00611421  6.81488053  4.34382955
50  9.49587968  7.65890124  9.33385333  9.16508124  8.65089742  6.81488053
51  9.97341622  8.05302609  9.55441301  9.54232332  9.16508124  7.00611421
52 10.08846261  8.11311393  9.39850861  9.55441301  9.33385333  6.87891756
53  8.46956627  6.55835421  8.11311393  8.05302609  7.65890124  5.57020162
54 10.33294589  8.46956627 10.08846261  9.97341622  9.49587968  7.55160339
55  9.14517138  7.20171566  8.65019886  8.67943638  8.35545404  6.10270654
56  8.52008616  6.58048431  8.05607453  8.06182497  7.72870979  5.50775580
57 10.70266952  8.76367709 10.19845093 10.24218760  9.90633592  7.65343100
58  9.05179629  7.08631138  8.44856309  8.54413766  8.28493862  5.90983551
59  9.91889417  8.02904460  9.60320501  9.52840680  9.09383679  7.05983173
60  9.13630740  7.15580993  8.42505315  8.58891459  8.39329657  5.90615384
            13          14          15          16          17          18
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14  0.51839102                                                            
15  0.37943534  0.85436861                                                
16  1.71961040  1.38855727  1.82698993                                    
17  0.40945951  0.64154562  0.37794814  1.44942760                        
18  0.26311550  0.65557944  0.21867747  1.63208609  0.19640612            
19  2.03252892  1.82450436  2.03024782  0.61163241  1.67881181  1.87511005
20  1.86391240  1.97841613  1.63827726  1.57043706  1.46011568  1.61064188
21  0.90774808  0.44156026  1.17288497  0.98539102  0.85295402  0.95479625
22  2.33464726  2.69490578  1.96889050  2.80927150  2.05403161  2.08923164
23  1.96295691  2.39072768  1.58387063  2.78908266  1.75964086  1.74504785
24  0.78305022  1.20935280  0.41087464  1.91872432  0.60016968  0.55857063
25  0.13163844  0.64276078  0.32836870  1.84239878  0.47967969  0.29771038
26  0.97075121  0.45273906  1.30060677  1.23689215  1.04129440  1.09363579
27  2.14771509  2.17405501  1.97146069  1.46391038  1.73828704  1.90963648
28  2.54481894  2.30654325  2.54948395  0.97052496  2.19703065  2.39319335
29  1.91971953  1.48260969  2.11191092  0.52069650  1.74155638  1.89912443
30  1.78097530  1.94545434  1.52561394  1.68330072  1.38742625  1.52159535
31  7.93557525  7.61284661  8.30460227  8.21617254  8.23820069  8.18283818
32  6.34614498  5.94485134  6.72545457  6.31183589  6.58625883  6.56943256
33  7.62350408  7.21798636  8.00287864  7.53588541  7.85952777  7.84541256
34  8.06357655  7.71019436  8.43813351  8.21410824  8.34470460  8.30340665
35  5.75508106  5.41790289  6.12775148  6.02737719  6.04711381  5.99834395
36  6.30718163  6.03591694  6.66463719  6.81147150  6.63904533  6.56288483
37  7.04590988  6.77328905  7.40314553  7.53037498  7.37748994  7.30162713
38  8.17438175  7.92173995  8.52498508  8.71060549  8.51647210  8.43273103
39  8.60398031  8.32965775  8.96076592  9.05843287  8.93531125  8.85976967
40  6.06801793  5.72733697  6.44113457  6.31661133  6.35776561  6.31055647
41  7.94883571  7.61588737  8.31989973  8.18774300  8.24462623  8.19381913
42  7.36035103  6.97569788  7.73868626  7.38196916  7.61586505  7.59023351
43  6.52988389  6.24432384  6.89095484  6.97860792  6.85424078  6.78358647
44  6.60253893  6.30464220  6.96662264  7.00453468  6.91994441  6.85424078
45  6.74877154  6.36449759  7.12714340  6.78656690  7.00453468  6.97860792
46  6.63536919  6.36254792  6.99297325  7.12714340  6.96662264  6.89095484
47  5.99517026  5.68457348  6.36254792  6.36449759  6.30464220  6.24432384
48  6.27546417  5.99517026  6.63536919  6.74877154  6.60253893  6.52988389
49  5.33993491  5.01621124  5.71042396  5.67927463  5.64070699  5.58608595
50  7.61007197  7.41887126  7.94004799  8.35137255  7.97762675  7.87262862
51  7.91753376  7.65492029  8.27131405  8.42284432  8.25463238  8.17470885
52  7.88785224  7.55607232  8.25871050  8.13259334  8.18442347  8.13309225
53  6.44287116  6.20321481  6.79087368  7.05070927  6.79012178  6.70219910
54  8.39245239  8.17491356  8.73130064  9.04228769  8.75020595  8.65379495
55  7.03935632  6.75915482  7.39866218  7.49697699  7.36690790  7.29400476
56  6.42752658  6.15785042  6.78443735  6.93467635  6.76028616  6.68347694
57  8.60079951  8.31443974  8.96089641  9.01137971  8.92559953  8.85484640
58  6.88685861  6.57842509  7.25322893  7.24301521  7.19812109  7.13673292
59  7.92816525  7.69315219  8.27331470  8.52696365  8.27828294  8.18816513
60  6.92018028  6.58401011  7.29217956  7.16578121  7.21342295  7.16412526
            19          20          21          22          23          24
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20  1.20293998                                                            
21  1.48741837  1.89016025                                                
22  2.52201040  1.32457296  2.80578232                                    
23  2.62418440  1.51208691  2.58342187  0.57981668                        
24  1.99637880  1.36754401  1.45220131  1.55814573  1.18674541            
25  2.13771014  1.90505751  1.03911719  2.29688505  1.90023932  0.73874457
26  1.77684480  2.19798916  0.31555487  3.06152763  2.80012786  1.63407621
27  0.96677687  0.42509094  2.00266880  1.67357216  1.92191834  1.74586349
28  0.51923883  1.56552712  1.93736524  2.88311936  3.05348783  2.50677512
29  1.07375497  2.08872187  1.04107615  3.30549485  3.24625222  2.28169678
30  1.36506739  0.19809165  1.90197615  1.15751397  1.31608685  1.22390738
31  8.82357962  9.52416596  7.63409404 10.27018418  9.86656745  8.71512968
32  6.90268712  7.73547196  5.87601213  8.63945338  8.30899350  7.12461488
33  8.11743856  8.98607799  7.13840170  9.91160916  9.58614282  8.40120087
34  8.81466272  9.57975401  7.69593976 10.39205882 10.01406732  8.84643706
35  6.63685310  7.32257302  5.43255043  8.08752016  7.70008688  6.53712555
36  7.42283753  7.99486626  6.11764254  8.63240230  8.19686692  7.07479550
37  8.14199328  8.72992495  6.85029695  9.37071979  8.93339290  7.81323533
38  9.32209456  9.88720976  8.01434320 10.48741823 10.03389001  8.93339290
39  9.66981034 10.28259308  8.39978731 10.92794056 10.48741823  9.37071979
40  6.92495774  7.62566721  5.73612310  8.39978731  8.01434320  6.85029695
41  8.79333467  9.51480531  7.62566721 10.28259308  9.88720976  8.72992495
42  7.97448478  8.79333467  6.92495774  9.66981034  9.32209456  8.14199328
43  7.59023351  8.19381913  6.31055647  8.85976967  8.43273103  7.30162713
44  7.61586505  8.24462623  6.35776561  8.93531125  8.51647210  7.37748994
45  7.38196916  8.18774300  6.31661133  9.05843287  8.71060549  7.53037498
46  7.73868626  8.31989973  6.44113457  8.96076592  8.52498508  7.40314553
47  6.97569788  7.61588737  5.72733697  8.32965775  7.92173995  6.77328905
48  7.36035103  7.94883571  6.06801793  8.60398031  8.17438175  7.04590988
49  6.29046066  6.93837792  5.04882750  7.67420118  7.27793460  6.12058051
50  8.95653872  9.39724587  7.56911423  9.87405072  9.38765751  8.34037117
51  9.03446129  9.61578387  7.73865556 10.23657388  9.79009806  8.68060625
52  8.73852335  9.45669859  7.56736612 10.22175620  9.82551578  8.66879887
53  7.66016066  8.17540647  6.31469295  8.75139430  8.29612885  7.19862180
54  9.65174408 10.15120253  8.29956127 10.67887311 10.20392625  9.13545005
55  8.10859019  8.71103627  6.82858233  9.36706788  8.93476211  7.80910076
56  7.54605154  8.11741391  6.24054743  8.75193032  8.31491596  7.19448965
57  9.62214043 10.25878110  8.37239524 10.92946334 10.49727275  9.37141813
58  7.85350572  8.50822311  6.61910690  9.22102553  8.80889192  7.66405852
59  9.13750221  9.66548551  7.80316966 10.22981337  9.76632582  8.67995272
60  7.77289203  8.48328308  6.59387543  9.25320255  8.86231803  7.70185934
            25          26          27          28          29          30
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26  1.09323032                                                            
27  2.20733277  2.31811436                                                
28  2.65253299  2.20454223  1.22474817                                    
29  2.05051584  1.17746644  1.97962321  1.27862109                        
30  1.80991610  2.20164088  0.62127220  1.75061608  2.19513837            
31  7.97853301  7.32878153  9.59778969  9.02682541  7.77036423  9.52941168
32  6.41463420  5.59309290  7.74873414  7.04370493  5.83036284  7.77036423
33  7.69274030  6.85977191  8.98415483  8.22914604  7.04370493  9.02682541
34  8.11581796  7.39821170  9.62615436  8.98415483  7.74873414  9.59778969
35  5.80393742  5.12768446  7.39821170  6.85977191  5.59309290  7.32878153
36  6.33629806  5.80393742  8.11581796  7.69274030  6.41463420  7.97853301
37  7.07479550  6.53712555  8.84643706  8.40120087  7.12461488  8.71512968
38  8.19686692  7.70008688 10.01406732  9.58614282  8.30899350  9.86656745
39  8.63240230  8.08752016 10.39205882  9.91160916  8.63945338 10.27018418
40  6.11764254  5.43255043  7.69593976  7.13840170  5.87601213  7.63409404
41  7.99486626  7.32257302  9.57975401  8.98607799  7.73547196  9.52416596
42  7.42283753  6.63685310  8.81466272  8.11743856  6.90268712  8.82357962
43  6.56288483  5.99834395  8.30340665  7.84541256  6.56943256  8.18283818
44  6.63904533  6.04711381  8.34470460  7.85952777  6.58625883  8.23820069
45  6.81147150  6.02737719  8.21410824  7.53588541  6.31183589  8.21617254
46  6.66463719  6.12775148  8.43813351  8.00287864  6.72545457  8.30460227
47  6.03591694  5.41790289  7.71019436  7.21798636  5.94485134  7.61284661
48  6.30718163  5.75508106  8.06357655  7.62350408  6.34614498  7.93557525
49  5.38523156  4.74063533  7.02795350  6.53415662  5.26032613  6.93838609
50  7.61599536  7.25393080  9.56723198  9.27163228  7.99694887  9.35552381
51  7.94298918  7.42503032  9.73622791  9.29262055  8.01639551  9.59844365
52  7.93356068  7.26395078  9.52294553  8.93320187  7.68144796  9.46548501
53  6.46299277  5.99937837  8.31728989  7.95228590  6.67407286  8.14861576
54  8.40504801  7.98404558 10.30209659  9.94172626  8.66322422 10.11856363
55  7.07041502  6.51614248  8.82205116  8.36155443  7.08616390  8.69892826
56  6.45608192  5.92678747  8.23887722  7.81554054  6.53748887  8.10071827
57  8.63269729  8.06153450 10.35898750  9.85315998  8.58454527 10.25085781
58  6.92622616  6.31026716  8.59868779  8.08377109  6.81485933  8.50619470
59  7.94586435  7.48799264  9.80553158  9.41780999  8.13923623  9.63850085
60  6.96779169  6.29044130  8.55125797  7.97627542  6.71931605  8.49199133
            31          32          33          34          35          36
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32  2.19513837                                                            
33  1.75061608  1.27862109                                                
34  0.62127220  1.97962321  1.22474817                                    
35  2.20164088  1.17746644  2.20454223  2.31811436                        
36  1.80991610  2.05051584  2.65253299  2.20733277  1.09323032            
37  1.22390738  2.28169678  2.50677512  1.74586349  1.63407621  0.73874457
38  1.31608685  3.24625222  3.05348783  1.92191834  2.80012786  1.90023932
39  1.15751397  3.30549485  2.88311936  1.67357216  3.06152763  2.29688505
40  1.90197615  1.04107615  1.93736524  2.00266880  0.31555487  1.03911719
41  0.19809165  2.08872187  1.56552712  0.42509094  2.19798916  1.90505751
42  1.36506739  1.07375497  0.51923883  0.96677687  1.77684480  2.13771014
43  1.52159535  1.89912443  2.39319335  1.90963648  1.09363579  0.29771038
44  1.38742625  1.74155638  2.19703065  1.73828704  1.04129440  0.47967969
45  1.68330072  0.52069650  0.97052496  1.46391038  1.23689215  1.84239878
46  1.52561394  2.11191092  2.54948395  1.97146069  1.30060677  0.32836870
47  1.94545434  1.48260969  2.30654325  2.17405501  0.45273906  0.64276078
48  1.78097530  1.91971953  2.54481894  2.14771509  0.97075121  0.13163844
49  2.59751062  1.53131594  2.63613258  2.75277252  0.44703026  1.21528606
50  2.25562912  3.67604683  3.84365280  2.87350896  2.87409809  1.78569897
51  1.09425460  2.93724184  2.79778923  1.71413439  2.49019122  1.62113307
52  0.18206777  2.05132333  1.56856487  0.46367752  2.13831580  1.84109568
53  1.97552062  2.51110809  3.04453551  2.45877636  1.53732555  0.46323701
54  1.97950364  3.84793843  3.71572338  2.58198802  3.28038073  2.27424870
55  1.14546622  2.17223993  2.38798606  1.64755299  1.56464461  0.74013282
56  1.72010945  2.09758327  2.64007815  2.14011306  1.18681487  0.12326420
57  0.98074845  3.16100537  2.67828815  1.46061446  2.99388211  2.30068661
58  1.07189649  1.69594583  1.96390210  1.41709481  1.22637778  0.79123082
59  1.56758099  3.30323331  3.25461864  2.18789373  2.72090414  1.73179873
60  1.05104843  1.30528476  1.51683703  1.18064078  1.16630999  1.15527586
            37          38          39          40          41          42
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32                                                                        
33                                                                        
34                                                                        
35                                                                        
36                                                                        
37                                                                        
38  1.18674541                                                            
39  1.55814573  0.57981668                                                
40  1.45220131  2.58342187  2.80578232                                    
41  1.36754401  1.51208691  1.32457296  1.89016025                        
42  1.99637880  2.62418440  2.52201040  1.48741837  1.20293998            
43  0.55857063  1.74504785  2.08923164  0.95479625  1.61064188  1.87511005
44  0.60016968  1.75964086  2.05403161  0.85295402  1.46011568  1.67881181
45  1.91872432  2.78908266  2.80927150  0.98539102  1.57043706  0.61163241
46  0.41087464  1.58387063  1.96889050  1.17288497  1.63827726  2.03024782
47  1.20935280  2.39072768  2.69490578  0.44156026  1.97841613  1.82450436
48  0.78305022  1.96295691  2.33464726  0.90774808  1.86391240  2.03252892
49  1.87673740  3.06313957  3.37997819  0.75757380  2.60967348  2.22038121
50  1.40367159  1.15150351  1.72057687  2.76927384  2.44880076  3.35158710
51  0.89247243  0.31527329  0.71379455  2.26954810  1.29226578  2.35082512
52  1.30970005  1.49571340  1.33340031  1.83140045  0.06456493  1.18891819
53  0.76038870  1.73780007  2.21756563  1.50193872  2.10613567  2.52558221
54  1.65006354  0.66367784  1.05854262  3.10026896  2.17507343  3.27967136
55  0.11977404  1.23862945  1.57155812  1.36740970  1.27940159  1.87703897
56  0.61881945  1.77697860  2.17648173  1.10689766  1.82362170  2.12245539
57  1.56721990  0.75006253  0.23375976  2.72473880  1.13311970  2.33591047
58  0.59594356  1.61882357  1.83595563  0.97503125  1.13693321  1.44568586
59  1.08920793  0.38696411  0.96555333  2.53930453  1.76546035  2.79433845
60  1.04769080  1.94224202  2.04726346  0.85789776  1.03233638  0.99764996
            43          44          45          46          47          48
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32                                                                        
33                                                                        
34                                                                        
35                                                                        
36                                                                        
37                                                                        
38                                                                        
39                                                                        
40                                                                        
41                                                                        
42                                                                        
43                                                                        
44  0.19640612                                                            
45  1.63208609  1.44942760                                                
46  0.21867747  0.37794814  1.82698993                                    
47  0.65557944  0.64154562  1.38855727  0.85436861                        
48  0.26311550  0.40945951  1.71961040  0.37943534  0.51839102            
49  1.31818544  1.32609062  1.66567417  1.49420813  0.68524223  1.12042768
50  1.81498504  1.94391339  3.32197673  1.59651739  2.42136093  1.90389040
51  1.44730417  1.45141616  2.48690386  1.29823894  2.08656812  1.67476348
52  1.54647784  1.39557528  1.53475308  1.57568390  1.91512820  1.79950243
53  0.65598007  0.84988660  2.28118206  0.50355720  1.09472715  0.59487143
54  2.18945999  2.25004289  3.41141291  1.99439130  2.84443695  2.36415429
55  0.51892472  0.52353643  1.80227210  0.41606090  1.15269034  0.76436922
56  0.24862704  0.44471015  1.86093766  0.21135312  0.73409025  0.21754458
57  2.07145702  2.01472367  2.65613054  1.97295129  2.64959206  2.32553623
58  0.49409730  0.32437397  1.32294145  0.59658162  0.89385652  0.73268446
59  1.63193518  1.68907170  2.88062253  1.44139379  2.28745655  1.81536319
60  0.88103608  0.68477869  0.88189867  1.03303119  0.99504315  1.06148254
            49          50          51          52          53          54
2                                                                         
3                                                                         
4                                                                         
5                                                                         
6                                                                         
7                                                                         
8                                                                         
9                                                                         
10                                                                        
11                                                                        
12                                                                        
13                                                                        
14                                                                        
15                                                                        
16                                                                        
17                                                                        
18                                                                        
19                                                                        
20                                                                        
21                                                                        
22                                                                        
23                                                                        
24                                                                        
25                                                                        
26                                                                        
27                                                                        
28                                                                        
29                                                                        
30                                                                        
31                                                                        
32                                                                        
33                                                                        
34                                                                        
35                                                                        
36                                                                        
37                                                                        
38                                                                        
39                                                                        
40                                                                        
41                                                                        
42                                                                        
43                                                                        
44                                                                        
45                                                                        
46                                                                        
47                                                                        
48                                                                        
49                                                                        
50  2.97734324                                                            
51  2.76322462  1.20376655                                                
52  2.54833030  2.41149003  1.26617539                                    
53  1.59335285  1.38676558  1.50641724  2.04545085                        
54  3.48455996  0.88457677  0.93205181  2.15935106  1.99159073            
55  1.82963125  1.51970893  0.93413311  1.21989116  0.83006203  1.73344050
56  1.33098223  1.68729651  1.49841863  1.76018760  0.42046677  2.15526850
57  3.33382442  1.90155401  0.80194527  1.14909888  2.26838052  1.28433375
58  1.57094434  1.99958046  1.30361914  1.07236928  1.09999168  2.17356876
59  2.93497108  0.76969745  0.47392361  1.73797453  1.49009895  0.56102733
60  1.58563594  2.44633119  1.63218494  0.97352038  1.52822999  2.54466030
            55          56          57          58          59
2                                                             
3                                                             
4                                                             
5                                                             
6                                                             
7                                                             
8                                                             
9                                                             
10                                                            
11                                                            
12                                                            
13                                                            
14                                                            
15                                                            
16                                                            
17                                                            
18                                                            
19                                                            
20                                                            
21                                                            
22                                                            
23                                                            
24                                                            
25                                                            
26                                                            
27                                                            
28                                                            
29                                                            
30                                                            
31                                                            
32                                                            
33                                                            
34                                                            
35                                                            
36                                                            
37                                                            
38                                                            
39                                                            
40                                                            
41                                                            
42                                                            
43                                                            
44                                                            
45                                                            
46                                                            
47                                                            
48                                                            
49                                                            
50                                                            
51                                                            
52                                                            
53                                                            
54                                                            
55                                                            
56  0.62707767                                                
57  1.56275359  2.18369179                                    
58  0.48073137  0.73320375  1.76968656                        
59  1.17280520  1.61079936  1.13450334  1.61894970            
60  0.92907961  1.12948863  1.93308906  0.46104542  2.00532308</code></pre>
</div>
</div>
<p>ie distance between point 1 and 2 is x, distance between point 1 and 3 is y etc.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>hc <span class="ot">&lt;-</span> <span class="fu">hclust</span>(d)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a>hc</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
hclust(d = d)

Cluster method   : complete 
Distance         : euclidean 
Number of objects: 60 </code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>To extract our cluster membership vector from a <code>hclust()</code> result object we have to “cut” our tree at a given height to yield separate “groups/branches”.</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(hc)</span>
<span id="cb36-2"><a href="#cb36-2" aria-hidden="true" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="dv">8</span>, <span class="at">col=</span><span class="st">"red"</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>to do this we use the <code>cutree()</code> function on our <code>hclust()</code> object:</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>grps <span class="ot">&lt;-</span> <span class="fu">cutree</span>(hc, <span class="at">h=</span><span class="dv">8</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a>grps</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 1 2 2 2 2 2 2 2 2
[39] 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2 2</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">table</span>(grps, km<span class="sc">$</span>cluster)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>    
grps  1  2
   1 30  0
   2  0 30</code></pre>
</div>
</div>
</section>
<section id="pca-of-uk-food-data" class="level2">
<h2 class="anchored" data-anchor-id="pca-of-uk-food-data">PCA of UK food data</h2>
<p>Import the dataset of food consumption in the UK</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>url <span class="ot">&lt;-</span> <span class="st">"https://tinyurl.com/UK-foods"</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url)</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                     X England Wales Scotland N.Ireland
1               Cheese     105   103      103        66
2        Carcass_meat      245   227      242       267
3          Other_meat      685   803      750       586
4                 Fish     147   160      122        93
5       Fats_and_oils      193   235      184       209
6               Sugars     156   175      147       139
7      Fresh_potatoes      720   874      566      1033
8           Fresh_Veg      253   265      171       143
9           Other_Veg      488   570      418       355
10 Processed_potatoes      198   203      220       187
11      Processed_Veg      360   365      337       334
12        Fresh_fruit     1102  1137      957       674
13            Cereals     1472  1582     1462      1494
14           Beverages      57    73       53        47
15        Soft_drinks     1374  1256     1572      1506
16   Alcoholic_drinks      375   475      458       135
17      Confectionery       54    64       62        41</code></pre>
</div>
</div>
<blockquote class="blockquote">
<ol start="17" type="A">
<li></li>
</ol>
</blockquote>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="fu">dim</span>(x)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17  5</code></pre>
</div>
</div>
<p>One solution is to set the row names is to do it by hands..</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb45"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a><span class="fu">rownames</span>(x) <span class="ot">&lt;-</span> x[,<span class="dv">1</span>]</span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a>x[,<span class="dv">1</span>]</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code> [1] "Cheese"              "Carcass_meat "       "Other_meat "        
 [4] "Fish"                "Fats_and_oils "      "Sugars"             
 [7] "Fresh_potatoes "     "Fresh_Veg "          "Other_Veg "         
[10] "Processed_potatoes " "Processed_Veg "      "Fresh_fruit "       
[13] "Cereals "            "Beverages"           "Soft_drinks "       
[16] "Alcoholic_drinks "   "Confectionery "     </code></pre>
</div>
</div>
<p>(computer went wierd and had to find the script.. thats why I might miss some annotations)</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb47"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">read.csv</span>(url, <span class="at">row.names=</span><span class="dv">1</span>)</span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a>x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                    England Wales Scotland N.Ireland
Cheese                  105   103      103        66
Carcass_meat            245   227      242       267
Other_meat              685   803      750       586
Fish                    147   160      122        93
Fats_and_oils           193   235      184       209
Sugars                  156   175      147       139
Fresh_potatoes          720   874      566      1033
Fresh_Veg               253   265      171       143
Other_Veg               488   570      418       355
Processed_potatoes      198   203      220       187
Processed_Veg           360   365      337       334
Fresh_fruit            1102  1137      957       674
Cereals                1472  1582     1462      1494
Beverages                57    73       53        47
Soft_drinks            1374  1256     1572      1506
Alcoholic_drinks        375   475      458       135
Confectionery            54    64       62        41</code></pre>
</div>
</div>
</section>
<section id="spotting-major-differences-and-trends" class="level2">
<h2 class="anchored" data-anchor-id="spotting-major-differences-and-trends">Spotting major differences and trends</h2>
<p>Is diffuclt even in this wee 17D dataset…</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="fu">barplot</span>(<span class="fu">as.matrix</span>(x), <span class="at">beside=</span>T, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="fu">nrow</span>(x)))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-28-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pairs-plot" class="level2">
<h2 class="anchored" data-anchor-id="pairs-plot">Pairs plot</h2>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pairs</span>(x, <span class="at">col=</span><span class="fu">rainbow</span>(<span class="dv">10</span>), <span class="at">pch=</span><span class="dv">16</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-29-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Pheatmap- hotter is there is more stuff, colder means less</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pheatmap)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">pheatmap</span>(<span class="fu">as.matrix</span>(x))</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-30-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pca-to-the-rescue" class="level2">
<h2 class="anchored" data-anchor-id="pca-to-the-rescue">PCA to the rescue</h2>
<p>The main PCA function in “base R” is called <code>prcomp()</code>. This function wants the transpose of our food data as input (ie the food as columsn and the countries as rows).</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb52"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>pca <span class="ot">&lt;-</span> <span class="fu">prcomp</span>(<span class="fu">t</span>(x))</span>
<span id="cb52-2"><a href="#cb52-2" aria-hidden="true" tabindex="-1"></a>pca</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Standard deviations (1, .., p=4):
[1] 3.241502e+02 2.127478e+02 7.387622e+01 2.699876e-14

Rotation (n x k) = (17 x 4):
                             PC1          PC2         PC3          PC4
Cheese              -0.056955380  0.016012850  0.02394295  0.739145824
Carcass_meat         0.047927628  0.013915823  0.06367111  0.578851042
Other_meat          -0.258916658 -0.015331138 -0.55384854 -0.084756407
Fish                -0.084414983 -0.050754947  0.03906481  0.001282376
Fats_and_oils       -0.005193623 -0.095388656 -0.12522257  0.012073959
Sugars              -0.037620983 -0.043021699 -0.03605745  0.011712878
Fresh_potatoes       0.401402060 -0.715017078 -0.20668248  0.098706764
Fresh_Veg           -0.151849942 -0.144900268  0.21382237  0.067864113
Other_Veg           -0.243593729 -0.225450923 -0.05332841  0.017187324
Processed_potatoes  -0.026886233  0.042850761 -0.07364902  0.020275689
Processed_Veg       -0.036488269 -0.045451802  0.05289191 -0.013653986
Fresh_fruit         -0.632640898 -0.177740743  0.40012865  0.088466607
Cereals             -0.047702858 -0.212599678 -0.35884921  0.201601167
Beverages           -0.026187756 -0.030560542 -0.04135860 -0.004452115
Soft_drinks          0.232244140  0.555124311 -0.16942648  0.212426744
Alcoholic_drinks    -0.463968168  0.113536523 -0.49858320  0.032075763
Confectionery       -0.029650201  0.005949921 -0.05232164  0.035241822</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb54"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(pca)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>Importance of components:
                            PC1      PC2      PC3     PC4
Standard deviation     324.1502 212.7478 73.87622 2.7e-14
Proportion of Variance   0.6744   0.2905  0.03503 0.0e+00
Cumulative Proportion    0.6744   0.9650  1.00000 1.0e+00</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb56"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="fu">attributes</span>(pca)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>$names
[1] "sdev"     "rotation" "center"   "scale"    "x"       

$class
[1] "prcomp"</code></pre>
</div>
</div>
<p>to make one of main PCA result figures we turn to <code>pca$x</code> the scores along our new PCs. This is called “PC plot” or “score plot” or “ordination plot”…</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb58"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>x</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                 PC1         PC2        PC3           PC4
England   -144.99315   -2.532999 105.768945  1.612425e-14
Wales     -240.52915 -224.646925 -56.475555  4.751043e-13
Scotland   -91.86934  286.081786 -44.415495 -6.044349e-13
N.Ireland  477.39164  -58.901862  -4.877895  1.145386e-13</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb60"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>my_cols <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"orange"</span>, <span class="st">"red"</span>, <span class="st">"blue"</span>, <span class="st">"darkgreen"</span>)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pca<span class="sc">$</span>x) <span class="sc">+</span></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(PC1, PC2) <span class="sc">+</span></span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">col=</span>my_cols)</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-36-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>the second major result figure is called a “loadings plot” of “variable contributions plot” or “weight plot”</p>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb62"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>pca<span class="sc">$</span>rotation</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output cell-output-stdout">
<pre><code>                             PC1          PC2         PC3          PC4
Cheese              -0.056955380  0.016012850  0.02394295  0.739145824
Carcass_meat         0.047927628  0.013915823  0.06367111  0.578851042
Other_meat          -0.258916658 -0.015331138 -0.55384854 -0.084756407
Fish                -0.084414983 -0.050754947  0.03906481  0.001282376
Fats_and_oils       -0.005193623 -0.095388656 -0.12522257  0.012073959
Sugars              -0.037620983 -0.043021699 -0.03605745  0.011712878
Fresh_potatoes       0.401402060 -0.715017078 -0.20668248  0.098706764
Fresh_Veg           -0.151849942 -0.144900268  0.21382237  0.067864113
Other_Veg           -0.243593729 -0.225450923 -0.05332841  0.017187324
Processed_potatoes  -0.026886233  0.042850761 -0.07364902  0.020275689
Processed_Veg       -0.036488269 -0.045451802  0.05289191 -0.013653986
Fresh_fruit         -0.632640898 -0.177740743  0.40012865  0.088466607
Cereals             -0.047702858 -0.212599678 -0.35884921  0.201601167
Beverages           -0.026187756 -0.030560542 -0.04135860 -0.004452115
Soft_drinks          0.232244140  0.555124311 -0.16942648  0.212426744
Alcoholic_drinks    -0.463968168  0.113536523 -0.49858320  0.032075763
Confectionery       -0.029650201  0.005949921 -0.05232164  0.035241822</code></pre>
</div>
</div>
<div class="cell">
<div class="code-copy-outer-scaffold"><div class="sourceCode cell-code" id="cb64"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="fu">ggplot</span>(pca<span class="sc">$</span>rotation) <span class="sc">+</span></span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">aes</span>(PC1, <span class="fu">rownames</span>(pca<span class="sc">$</span>rotation)) <span class="sc">+</span></span>
<span id="cb64-3"><a href="#cb64-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_col</span>()</span></code></pre></div><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="Class07_files/figure-html/unnamed-chunk-38-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->




</body></html>