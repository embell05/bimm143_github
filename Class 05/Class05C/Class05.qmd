---
title: "Class 5: Data Vis with ggplot"
author: "Emma Bell (PID:A19247017)"
format: pdf
toc: true
---

## Background

There are lots of ways to make visualisations and plots in R. These include so called "base R" (like the `plot()`) and add on pakages like **ggplot2**.

Let's make the same plot with these two graphic systems. We can use the inbuilt `cars` dataset:

```{r}
head(cars)
```
(You can use tail for the last 6 of the data set)

With "base R" we can simply:

```{r}
plot(cars)
```

Now let's try ggplot. First I need to install the package using `install.packages("ggplot2")`. 

> **N>B** We never run an `install.packages()` in a code chunk otherwise we will re-install needlessly everytime we render our document. 

Everytime we want to use an add-on package we need to load it up with a call to `library()` 
```{r}
library(ggplot2)
ggplot(cars)
```
Every ggplot needs at least three things:
1. The **data** ie stuff to plot as a data.frame
2. The **aes** or aesthetics that map the data to the plot
3. The **geom_** or geometry ie the plot type such as points, lines etc

```{r}
ggplot(cars) + aes(x = speed, y = dist) + geom_point()
```

```{r}
ggplot(cars) + aes(x=speed, y=dist) + geom_point() + geom_smooth()
```

```{r}
ggplot(cars) + aes(x=speed, y=dist) + geom_point() + geom_smooth(method=lm, se=FALSE)
```

```{r}
ggplot(cars) + aes(x=speed, y=dist) + geom_point() + geom_smooth(method=lm, se=FALSE) + labs(x="Speed (mph)", y="Stopping (ft)", title= "Stopping Distance of Old Cars") + theme_bw()
```

## Gene Expression Plot##

Read some data on the effects of GLP-1 inhibitor (drug) on gene expression values.

```{r}
url <- "https://bioboot.github.io/bimm143_S20/class-material/up_down_expression.txt"
genes <- read.delim(url)
head(genes)
```



Version 1 plot - start  simple by getting some ink on the page.

```{r}
ggplot(genes) +
  aes(Condition1, Condition2 ) +
  geom_point()
```

```{r}
ggplot(genes) +
  aes(Condition1, Condition2 ) +
  geom_point(col="blue")
```


```{r}
ggplot(genes) +
  aes(Condition1, Condition2 ) +
  geom_point(col="blue", alpha=0.2)
```

Let's colour by `State` up, down or not changing. 



```{r}
ggplot(genes) +
  aes(Condition1, Condition2, col=State ) +
  geom_point() + scale_color_manual(values = c("pink", "cyan", "orange")) + labs(x= "Control (no drug)", y= "Drug Treatment", title="Expression Changes with GLP-1 Drug")
```


```{r}
ggplot(genes) +
  aes(Condition1, Condition2, col=State ) +
  geom_point() + scale_color_manual(values = c("pink", "cyan", "orange")) + labs(x= "Control (no drug)", y= "Drug Treatment", title="Expression Changes with GLP-1 Drug") + theme_bw()
```
```{r}
nrow(genes)
```
```{r}
ncol(genes)
```
```{r}
table(genes$State)
```
```{r}
round(table(genes$State)/nrow(genes)*100, 2)
```


## Going Further with Gapminder##

Here we explore the famous `gapminder` dataset with some custom plots. 

```{r}
# File location online
url <- "https://raw.githubusercontent.com/jennybc/gapminder/master/inst/extdata/gapminder.tsv"

gapminder <- read.delim(url)
head(gapminder)
```
> Q. How many rows does this dataset have?

```{r}
nrow(gapminder)
```

> How many different continents are in this dataset?

```{r}
table(gapminder$continent)
```
Version 1 plot gdpPercap vs LifeExp for all rows
```{r}
ggplot(gapminder) + aes(gdpPercap, lifeExp) + geom_point()
```

```{r}
ggplot(gapminder) + aes(gdpPercap, lifeExp, color= continent) + geom_point() 
```

I want to see a separate plot for each continent - in ggplot lingo this is called "faceting"
```{r}
ggplot(gapminder) + aes(gdpPercap, lifeExp, color= continent) + geom_point() + 
  facet_wrap(~continent)
```

## First look at the dplr package

Another add on package with a function called `filter()` that we want to use.

```{r}
library(dplyr)
```
```{r}
filter(gapminder, year==2007, country=="United Kingdom")
```

```{r}
input <- filter(gapminder, year==2007 | year == 1977)
```

```{r}

ggplot(input) + aes(gdpPercap, lifeExp, col=continent) + geom_point() + facet_wrap(~year)
```

